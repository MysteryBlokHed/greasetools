// ==UserScript==
// @name        greasetools
// @description Functions and other tools for GreaseMonkey UserScript development.
// @version     0.4.0
// @author      Adam Thompson-Sharpe
// @license     MIT OR Apache-2.0
// @homepageURL https://gitlab.com/MysteryBlokHed/greasetools#greasetools
// ==/UserScript==
(()=>{"use strict";var e={892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.genBanner=void 0,t.genBanner=function(e,t=12){let n="// ==UserScript==\n";const r=(e,n)=>`// @${e}${" ".repeat(t-e.length)}${n}\n`;for(const[t,o]of Object.entries(e))if(o)if("string"==typeof o)n+=r(t,o);else for(const e of o)e&&(n+=r(t,e));return n+="// ==/UserScript==\n",n}},568:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.checkGrants=void 0,o(n(892),t),o(n(286),t),o(n(636),t),t.checkGrants=function(...e){return!!GM&&!e.some((e=>!(e in GM)))}},636:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteValue=t.valuesGetProxy=t.valuesProxy=t.getAllValues=t.getValues=void 0;const r=n(568);function o(e){for(const t of Object.values(e))if("string"!=typeof t)throw TypeError("Only strings are supported for values when localStorage is being used")}const s=(e,t)=>t?`${t}.${e}`:e;function a(e,t,n=!1){return new Promise(((a,c)=>{const l=e,i=n?(0,r.checkGrants)("getValue"):(0,r.checkGrants)("getValue","setValue");if(i||o(Object.values(l)),i){const r=(e,t,r)=>new Promise((async o=>{const a=s(e,r),c=await GM.getValue(a);return c?o([e,c]):(n&&await GM.setValue(e,t),o([e,t]))})),o=[];for(const[n,s]of Object.entries(e))o.push(r(n,s,t));Promise.all(o).then((e=>{const t={};for(const[n,r]of e)t[n]=r;a(t)})).catch((e=>c(e)))}else{const t={};for(const[r,o]of Object.entries(e)){const e=localStorage.getItem(r);null===e&&n&&localStorage.setItem(r,o),t[r]=null!=e?e:o}a(t)}}))}t.getValues=a,t.getAllValues=async function(){const e=await(async()=>(0,r.checkGrants)("getValue","listValues")?GM.listValues():Object.keys(localStorage))();return a((()=>{const t={};for(const n of e)t[n]="";return t})())},t.valuesProxy=function(e,t,n){const a=(0,r.checkGrants)("setValue");return new Proxy(e,{set(e,r,c){const l=s(r,t);if(r in e){if(a){const e=GM.setValue(l,c);n&&n(e)}else o([c]),localStorage.setItem(l,c);return Reflect.set(e,r,c)}return!1}})},t.valuesGetProxy=function(e,t){const n=(0,r.checkGrants)("getValue");return new Proxy(e,{get:(e,r)=>new Promise(((o,a)=>{const c=s(r,t);if(r in e)if(n)GM.getValue(c).then((e=>{void 0!==e?o(e):a()}));else{const e=localStorage.getItem(c);null!==e?o(e):a()}else a()})),set:()=>!1})},t.deleteValue=function(e,t,n){return new Promise((async(o,a)=>{const c=s(t,n);t in e&&((0,r.checkGrants)("deleteValue")?await GM.deleteValue(c):localStorage.removeItem(c),delete e[t],o(e)),a()}))}},286:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.xhrPromise=void 0;const r=n(568);t.xhrPromise=function(e){return new Promise(((t,n)=>{let o=XMLHttpRequest.UNSENT;(0,r.checkGrants)("xmlHttpRequest")?GM.xmlHttpRequest(Object.assign(Object.assign({},e),{onreadystatechange:e=>{e.readyState===XMLHttpRequest.DONE&&(o<3?n(new Error("XHR failed")):t(e)),o=e.readyState}})):n(new Error("Missing grant GM.xmlHttpRequest"))}))}}},t={};var n=function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}(568);window.GreaseTools=n})();